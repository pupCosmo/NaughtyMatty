<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <title>Document</title>
</head>

<body>

    <div class="jumbotron">
        <h1 class="display-4">Matty was bad!</h1>
        <p class="lead">Click on the button for a random punisment!</p>
        <hr class="my-4">
        <p id="punishment"></p>
        <a class="btn btn-primary btn-lg" href="#" role="button" id="get-punishment">Punish!</a>
        <input class="form-control" type="text" placeholder="Enter your name (optional)" id="user-name"
            style="width: 250px; margin-top: 5px">
    </div>
    <div>
        <button type="button" class="btn btn-outline-primary" id="log-button"> &#x21ba; Punishment Log</button>
        <div id="log-table" style="margin-top: 5px">
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase.js"></script>

    <script>
        var punishments = [
            "When padded must not conceal diapers except in public",
            "When padded must be leaking to change",
            "Resupplying, must buy a case of sissy diapers",
            "Must whimper or cry audibly when using diapers",
            "Must post photos of written diapers each change",
            "Feed your padding a large helping of oatmeal front and back once a week",
            "When padded must be doubled",
            "When padded cannot change yourself",
            "If at home before changing flood your diaper until it over flows, keep it on another 30 minutes",
            "Must be sucking on something (thumb/paci) at all feasible times",
            "When padded must be messy to change",
            "Must wear sissy attire except when in public",
            "Ride horse cock for one hour - no clit touching",
            "Must drink 20oz of liquid within an hour of bed; cannot leave bed for at least 6 hours for any reason",
            "When padded must have a daily enema",
            "Wear nightdress to sleep for a week.",
            "When padded must wear clothing that teases diapered state",
            "When padded can only change if it time/60 = int",
            "Plugged for 24 hours - Big's choice",
            "roll once more, this is now permanent.",
            "Getting neutered - banding with hair tie for 30 minutes",
            "must publically (irc/twitter) announce diaper status every 3 hours",
            "must have visible diaper waistband peeking out pants at all times (including in public)",
            "No touching clit until vaginal orgasm. 30 minutes every day until orgasm.",
            "May only eat food from a bowl on the floor",
            "must sleep with hypnotic loop playing in background",
            "must watch 60 minutes of pre-school television or video",
            "Must have Magnesium Citrate before bed",
            "Boosted, purchase a diaper booster pad, you have to start using them too",
            "Must hump a plushie until you have climaxed three times, can't stop humping until you do.",
            "must receive verbal or written permission to change",
            "Can only paw off once for 1 minute or twice for 30 seconds each day for 1 week",
            "must orgasm in diapers before changing into new one (lasts 2 days)",
            "must obey orders for anyone in sissy wear or diapers",
            "After messing yourself, mush the mess up against yourself or give yourself a wedgie before getting changed",
            "Letters, write an embarassing message on each diaper you wear, take a pic to show it off.",
            "Laxatives, every lunch time take a laxative",
            "Limited changes you can only change once a day",
            "Use suppositories",
            "Drink a glass of water every 60 minutes for the whole day",
            "Whilst at home you have to crawl, right until you get to the door",
            "Chat on chatroulette/omegal for 30 minutes with your diaper visible the entire time",
            "Plugs, wear a toy in your butt during the night, flip a coin for vibrating (H no, T yes)",
            "Pour oatmeal down the back of your diaper and sleep in it",
            "mess and wet outside while lifting your leg on a tree as if you are marking your territory",
            "bark loudly whenever you wet or mess your diaper until you've barked 5 times",
            "watch my little ponies. not the new one the old one. and sing and clap along to the show",
            "pacified, when not in public, suckle on a pacifier",
            "You aren't allowed to mess or wet in the house. That includes while you're asleep. (2 days)",
            "Ask a bully cub for some new orders",
            "Chastity for 2 weeks",
            "Chastity for 1 week",
            "Chastity for 3 days",
            "Not allowed release until piggy takes a load of cum in his mouth or cunny",
            "Enema game - must hold for 10 minutes. If successful, use the potty and cum, if not lick mud",
            "Dolcolax suppository and walk about the park until messed",
            "Spanking (reps and implement to be decided by big)",
            "Chilled banana suppository. Must eat out of diaper after.",
            "Snout wallowing",
            "Wear cute shiny skirt... in public.",
            "speech restriction - only allowed to vocalize in cries and whines.",
            "Food restriction - meals for the next 12 hours restricted to baby food.",
            "Drink restrictions - may only use baby bottle for 24h",
            "Must beg to refill diaper pail",
            "Two hours to knot Chase AND hilt Chance"
        ]

        $('#punishment').text(punishments.length + " punishments to choose from!");
        var config = {
            apiKey: "AIzaSyBMAit6mqm5Wcdb1P0UO14Njfptuk_vgho",
            authDomain: "mattylog-5c326.firebaseapp.com",
            databaseURL: "https://mattylog-5c326.firebaseio.com",
            projectId: "mattylog-5c326",
            storageBucket: "mattylog-5c326.appspot.com",
            messagingSenderId: "560598744377",
            appId: "1:560598744377:web:872a4456d44db7da"
        };
        // Initialize Firebase
        firebase.initializeApp(config);
        var database = firebase.database();
        firebase.database().ref().once('value').then(function (snapshot) {
            logArr = (snapshot.val().Log);
        });

        $("#get-punishment").on("click", function (event) {
            event.preventDefault();
            $("#punishment").empty();
            var rand = Math.floor(Math.random() * punishments.length);
            var text = punishments[rand];
            $("#punishment").text(text);
            userName = getUser();
            writeLog(text, userName);
        });


        function writeLog(punishment, user) {

            firebase.database().ref().once('value').then(function (snapshot) {
                console.log(snapshot);
                logArr = (snapshot.val().Log);
                console.log(logArr);
                var newEntry = {
                    time: moment().format("DD/MM/YY hh:mm A"),
                    punishment: punishment,
                    user: user
                }
                logArr.push(newEntry);
                database.ref().set({
                    Log: logArr
                });
            });
        }



        $("#log-button").on("click", function (event) {
            writeTable(logArr);
        });

        function getUser() {
            var user = " ";
            var textInput = $("#user-name").val();
            if (textInput) {
                user = textInput;
            }
            return user;
        }


        function writeTable(arr) {
            $('#log-table').empty();

            var table = $('<table>', { class: 'table table-dark' });
            var head = $('<thead>');
            var row = $('<tr>');
            var cell1 = $('<th>', { scope: 'col' }).text('Time').appendTo(row);
            var cell2 = $('<th>', { scope: 'col' }).text('Punishment').appendTo(row);
            var cell3 = $('<th>', { scope: 'col' }).text('Submitted By').appendTo(row);

            row.appendTo(head);
            head.appendTo(table);
            table.appendTo('#log-table');

            var body = $('<tbody>');

            for (var i = arr.length - 1; i > 0; i--) {
                var text = String(arr[i].user);
                if (text == 'TEST' || text == 'Test' || text == 'test' || text == ' ') {
                    //do nothing because ! and && wasn't working
                }else{
                    var tableRow = $('<tr>').appendTo(body);
                    $('<th>', { scope: 'row' }).text(arr[i].time).appendTo(tableRow);
                    $('<td>').text(arr[i].punishment).appendTo(tableRow);
                    $('<td>').text(arr[i].user).appendTo(tableRow);
                }
            }
            body.appendTo(table);
        }

    </script>






</body>

</html>
